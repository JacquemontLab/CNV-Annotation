//defining static resource file paths which are consistent across all runs
params {
    vep_cache      = "/lustre06/project/6008022/All_user_common_folder/SOFTWARE/VEP/cache"
    genome_regions = "/lustre06/project/6008022/clarkb/CNV-DB-Builder/resources/Genome_Regions/Genome_Regions_data.tsv"
    //HG38 specific gnomad file
    gnomad_AF      = "/lustre06/project/6008022/All_user_common_folder/SOFTWARE/VEP/cache/ressources_gnomAD/gnomad.v4.1.sv.sites.vcf.bgz"
}

// vep_annotate configurations 
process {
    executor = 'slurm'
     withLabel: vep {
        cpus = 16
        module = ['apptainer/1.3.5', 'htslib/1.19']
        container = '/lustre06/project/6008022/All_user_common_folder/SOFTWARE/VEP/vep.sif'
        clusterOptions = '--mem-per-cpu 3500MB --account=rrg-jacquese'
        time = '1h'
        }

     withLabel: quick {
        executor = 'local'
     }
     withLabel: long {
        clusterOptions = '--mem-per-cpu 3500MB \
        --account=rrg-jacquese \
        --ntasks 1 \
        --cpus-per-task 8'
     }
     withLabel : polars {
        beforeScript =      '''
                            module load python/3.13.2
                            virtualenv --no-download $SLURM_TMPDIR/env
                            source $SLURM_TMPDIR/env/bin/activate
                            pip install --no-index --upgrade pip
                            pip install --no-index polars
                           '''
     }

    withName: buildCnvDB {
        module = "bedtools/2.31.0"
        //cpus = 4
        //clusterOptions = '--mem-per-cpu 3500MB --account=rrg-jacquese'
    }
}

manifest {
    contributors    = [[ name : "Florian Bénitière", github : "https://github.com/FloBeni",          contribution : "author" ],
                       [ name : "Benjamin Clark",    github : "https://github.com/Benjamin-R-Clark", contribution : "author" ]
                       ]
    version         = "0.1"
    name            = "CNV-DB-Builder-lite"
    homePage        = "https://github.com/JacquemontLab/CNV-DB-Builder-lite"
    nextflowVersion = '25.04.2'
    organization    = "https://github.com/JacquemontLab"
    description     = "Nextflow pipeline for annotating CNV information. Only requires CNV positions, type and SampleID"
}
